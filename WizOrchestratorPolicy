{
	"Version": "2012-10-17",
	"Statement": [
		{
			"Action": "iam:PassRole",
			"Resource": [
				"arn:aws:iam::*:role/*WizOrchestrator*"
			],
			"Effect": "Allow"
		},
		{
			"Action": [
				"eks:DeleteCluster",
				"eks:DeleteNodegroup"
			],
			"Resource": [
				"arn:aws:eks:*:*:cluster/wiz-orchestrator*",
				"arn:aws:eks:*:*:nodegroup/wiz-orchestrator*/*/*"
			],
			"Effect": "Allow"
		},
		{
			"Action": [
				"secretsmanager:GetSecretValue",
				"secretsmanager:PutSecretValue",
				"secretsmanager:CreateSecret",
				"secretsmanager:DeleteSecret",
				"secretsmanager:UpdateSecret"
			],
			"Resource": [
				"arn:aws:secretsmanager:*:*:secret:wiz/*"
			],
			"Effect": "Allow"
		},
		{
			"Action": [
				"sqs:GetQueueAttributes",
				"sqs:GetQueueUrl",
				"sqs:SendMessageBatch",
				"sqs:SendMessage",
				"sqs:ReceiveMessage",
				"sqs:ChangeMessageVisibility",
				"sqs:RemovePermission",
				"sqs:AddPermission",
				"sqs:PurgeQueue",
				"sqs:DeleteQueue",
				"sqs:ChangeMessageVisibilityBatch",
				"sqs:SetQueueAttributes",
				"sqs:TagQueue",
				"sqs:UntagQueue"
			],
			"Resource": "arn:aws:sqs:*:*:diskanalyzer-scans*",
			"Effect": "Allow"
		},
		{
			"Action": [
				"autoscaling:AttachInstances",
				"autoscaling:CreateAutoScalingGroup",
				"autoscaling:CreateLaunchConfiguration",
				"autoscaling:CreateOrUpdateTags",
				"autoscaling:DeleteAutoScalingGroup",
				"autoscaling:DeleteLaunchConfiguration",
				"autoscaling:DeleteTags",
				"autoscaling:DescribeAutoScalingGroups",
				"autoscaling:DetachInstances",
				"autoscaling:SetDesiredCapacity",
				"autoscaling:SuspendProcesses",
				"autoscaling:UpdateAutoScalingGroup",
				"ec2:DescribeAddresses",
				"ec2:AssociateIamInstanceProfile",
				"ec2:AuthorizeSecurityGroupIngress",
				"ec2:DescribeDhcpOptions",
				"ec2:CreateLaunchTemplate",
				"ec2:CreateLaunchTemplateVersion",
				"ec2:DescribeNetworkInterfaces",
				"ec2:DescribeNatGateways",
				"ec2:CreateRoute",
				"ec2:CreateSecurityGroup",
				"ec2:CreateTags",
				"ec2:CreateVolume",
				"ec2:DescribeInternetGateways",
				"ec2:DeleteLaunchTemplate",
				"ec2:DeleteLaunchTemplateVersions",
				"ec2:DeleteRoute",
				"ec2:DeleteSecurityGroup",
				"ec2:DeleteTags",
				"ec2:DeleteVolume",
				"ec2:DescribeInstances",
				"ec2:DescribeRouteTables",
				"ec2:DescribeSecurityGroups",
				"ec2:DescribeSubnets",
				"ec2:DescribeVolumes",
				"ec2:DescribeVolumesModifications",
				"ec2:DescribeVpcs",
				"ec2:DescribeDhcpOptions",
				"ec2:DescribeNetworkInterfaces",
				"ec2:DescribeAvailabilityZones",
				"ec2:DescribeAccountAttributes",
				"ec2:DescribeAddresses",
				"ec2:DescribeInternetGateways",
				"ec2:DescribeLaunchTemplateVersions",
				"ec2:DescribeLaunchTemplates",
				"ec2:DescribeSecurityGroups",
				"ec2:DescribeSubnets",
				"ec2:DescribeVpcs",
				"ec2:DetachVolume",
				"ec2:GetLaunchTemplateData",
				"ec2:ModifyLaunchTemplate",
				"ec2:RevokeSecurityGroupIngress",
				"ec2:RunInstances",
				"ec2:DescribeNatGateways",
				"ec2:DescribeNetworkAcls",
				"ec2:DescribeNetworkInterfaces",
				"ec2:DescribeVpcEndpoints",
				"eks:CreateCluster",
				"eks:CreateFargateProfile",
				"eks:CreateNodegroup",
				"eks:DeleteFargateProfile",
				"eks:DescribeCluster",
				"eks:DescribeFargateProfile",
				"eks:DescribeNodegroup",
				"eks:DescribeUpdate",
				"eks:ListClusters",
				"eks:ListFargateProfiles",
				"eks:ListNodegroups",
				"eks:ListTagsForResource",
				"eks:TagResource",
				"eks:UntagResource",
				"eks:UpdateClusterConfig",
				"eks:UpdateClusterVersion",
				"eks:UpdateNodegroupConfig",
				"eks:UpdateNodegroupVersion",
				"iam:AddRoleToInstanceProfile",
				"iam:CreateInstanceProfile",
				"iam:CreateOpenIDConnectProvider",
				"iam:CreateServiceLinkedRole",
				"iam:DeleteInstanceProfile",
				"iam:DeleteOpenIDConnectProvider",
				"iam:GetInstanceProfile",
				"iam:GetOpenIDConnectProvider",
				"iam:GetPolicy",
				"iam:GetPolicyVersion",
				"iam:GetRole",
				"iam:GetRolePolicy",
				"iam:ListUsers",
				"iam:ListMFADevices",
				"iam:ListServerCertificateTags",
				"iam:ListPoliciesGrantingServiceAccess",
				"iam:ListOpenIDConnectProviderTags",
				"iam:ListSigningCertificates",
				"iam:ListAccountAliases",
				"iam:ListMFADeviceTags",
				"iam:ListGroupPolicies",
				"iam:ListSAMLProviders",
				"iam:ListOpenIDConnectProviders",
				"iam:ListSTSRegionalEndpointsStatus",
				"iam:ListVirtualMFADevices",
				"iam:ListCloudFrontPublicKeys",
				"iam:ListPolicyVersions",
				"iam:ListUserPolicies",
				"iam:ListSSHPublicKeys",
				"iam:ListRolePolicies",
				"iam:ListAttachedRolePolicies",
				"iam:ListRoleTags",
				"iam:ListInstanceProfilesForRole",
				"iam:ListPolicies",
				"iam:ListAttachedGroupPolicies",
				"iam:ListServerCertificates",
				"iam:ListGroupsForUser",
				"iam:ListRoles",
				"iam:ListServiceSpecificCredentials",
				"iam:ListInstanceProfileTags",
				"iam:ListAttachedUserPolicies",
				"iam:ListEntitiesForPolicy",
				"iam:ListPolicyTags",
				"iam:ListUserTags",
				"iam:ListAccessKeys",
				"iam:ListInstanceProfiles",
				"iam:ListSAMLProviderTags",
				"iam:ListGroups",
				"iam:TagRole",
				"iam:UntagRole",
				"kms:CreateGrant",
				"kms:CreateKey",
				"kms:DescribeKey",
				"kms:EnableKeyRotation",
				"kms:GetKeyPolicy",
				"kms:GetKeyRotationStatus",
				"kms:ListResourceTags",
				"kms:ScheduleKeyDeletion",
				"kms:TagResource",
				"kms:UntagResource",
				"sqs:ListQueues",
				"sqs:ListQueueTags",
				"sqs:ListDeadLetterSourceQueues",
				"sqs:CreateQueue",
				"secretsmanager:ListSecrets"
			],
			"Resource": [
				"*"
			],
			"Effect": "Allow"
		}
	]
}